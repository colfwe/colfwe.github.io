* è®°å½•ä¸€æ¬¡å®‰è£…Arch-Linuxçš„ä¸ªäººæµç¨‹

** ç‰¹åˆ«æ„Ÿè°¢

- [[https://www.bilibili.com/video/BV1ag411K725][ã€archlinuxã€‘åŒç³»ç»ŸçœŸæœºå®‰è£…æ¼”ç¤º]]

- [[https://arch.icekylin.online/guide/rookie/graphic-driver#intel-%E6%A0%B8%E8%8A%AF%E6%98%BE%E5%8D%A1][è§£å†³intelæ ¸æ˜¾åœ¨KDE sddmä¸‹èŠ±å±çš„é—®é¢˜-å³ä¸å®‰è£…xf86-video-intel]]

** efiåˆ†åŒºæ‰©å®¹

å› ä¸ºåœ¨Windowsä¸‹ï¼Œé»˜è®¤ ~EFIåˆ†åŒº~ å¤§å°æ˜¯100MiB (è¯¢é—®è¿‡AIï¼ŒGPTçš„å¤§æ¦‚æ„æ€æ˜¯è¯´å› ä¸ºMSçš„EFIç­–ç•¥æ¯”è¾ƒç²¾ç®€ï¼Œåšäº†å¤§é‡çš„è€¦åˆï¼Œæ‰€ä»¥é»˜è®¤EFIå¤§å°å®¹é‡å°±å¯ä»¥ç¼©åˆ°ç‰¹åˆ«å°)

ä½†æ˜¯å½“å¦‚æœEFIå¤§å°å®¹é‡è¿‡å°çš„è¯ï¼Œå°±åŸºæœ¬æ˜¯ä¸å¤Ÿçš„ã€‚ç„¶åå¼„è¿‡(B)oot(L)ooderæ¯”å¦‚grubã€æ¯”å¦‚OCä¹‹ç±»çš„ï¼Œå°±ä¼šæœ‰ä¸€äº› ~EFIå¤§å°å®¹é‡ä¸å¤Ÿçš„é”™è¯¯æç¤º~

æ¯”å¦‚å¦‚æœå®¹é‡ä¸å¤Ÿï¼Œå°±ä¼šåœ¨ ~grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=grub~ è¿™ä¸€æ­¥å°±ä¼šå‡ºç° *grub error: no left space to create a directoryçš„é”™è¯¯ï¼Œä»è€Œå¯¼è‡´å¼•å¯¼ä¸äº†ArchLinuxç³»ç»Ÿï¼Œä»è€Œå¯¼è‡´ç³»ç»Ÿçš„ç¡®æ˜¯å®‰è£…åœ¨ç¡¬ç›˜ä¸Šäº†ï¼Œä½†å°±æ˜¯è¿›ä¸å»ï¼Œå› ä¸ºæ²¡æœ‰â€œé’¥åŒ™â€ï¼Œè£…äº†ä¹Ÿæ˜¯ç™½è£…ï¼Œä¸‹ä¸€æ¬¡è¿›ç³»ç»Ÿè¿˜æ˜¯Windows* 

å¦‚æœæ˜¯ ~é‡è£…Windowsç³»ç»Ÿ~ å³ *Windowsè¿˜æ²¡æœ‰å®‰è£…å¥½* é‚£ä¹ˆ

#+begin_src sh
  # åˆ›å»ºä¸€ä¸ª1000Mçš„EFIåˆ†åŒºï¼Œç”¨æ¥ä¿å­˜æ¥ä¸‹æ¥çš„grub-installæ–‡ä»¶
  diskpart
  list disk
  select disk X  # Xæ˜¯ä½ çš„ç›®æ ‡ç£ç›˜ç¼–å·
  create partition efi size=1000
  format fs=fat32 quick  
#+end_src

å¦‚æœæ˜¯ ~å·²å®‰è£…å¥½Windowsç³»ç»Ÿ~ å³ *Windowså·²ç»å®‰è£…å¥½ï¼ŒArchLinuxå‘è¡Œç‰ˆè¿˜æ²¡æœ‰å®‰è£…å¥½* é‚£ä¹ˆ

#+begin_src sh
  # åˆ›å»ºä¸€ä¸ª1000Mçš„EFIåˆ†åŒºï¼Œç”¨æ¥ä¿å­˜æ¥ä¸‹æ¥çš„grub-installæ–‡ä»¶
  # administratoræ‰“å¼€cmd  
  diskpart

  list disk

  select disk <åˆ†å‡º1024MiBçš„é‚£ä¸ªdiskçš„ç¼–å·>

  list partition

  create partition efi

  format quick fs = fat32

  # åˆ›å»ºæŒ‚è½½ç‚¹åˆ«åP
  assign letter = P

  exit  
    
#+end_src

** ä¸‹è½½é•œåƒ

æˆ‘ä»¬åˆ°è¿™é‡Œ [[https://archlinux.org/download/][archlinux.org/download]] ä¸‹è½½ torrent æ¯æœˆæ›´æ–°çš„ç§å­æ–‡ä»¶

æˆ‘æ¨èçš„æ˜¯ä½¿ç”¨ ~bitCometæ¯”ç‰¹å½—æ˜Ÿ~ æ¥ä¸‹è½½ (åœ¨Windowsä¸‹ï¼Œå¯ä»¥é€šè¿‡chocolatey softwareçš„ ~choco install bitComet~) æ¥å®‰è£…

åŒæ—¶ï¼Œè®°å¾—æ¯ä¸ªæœˆçš„æœˆåˆæ—¶ï¼Œä¸ªäººå»ºè®®æœ€å¥½ä¸‹è½½å®Œæ¯•åï¼Œåå°æŒ‚ä¸€ä¼šbitCometï¼Œæ¯•ç«ŸP2Pæ¨¡å¼äººäººä¸ºæˆ‘æˆ‘ä¸ºäººäººã€‚ä¸è¿‡éš¾å…æœ‰åäººbad guyï¼Œä½†é‚£å¯èƒ½åº”è¯¥æ˜¯åšç§å­é‚£æ–¹çš„ç»´æŠ¤è€…éœ€è¦è€ƒè™‘çš„äº‹æƒ…äº†

ç„¶ååˆ»ç›˜ï¼Œæˆ‘æ¨èç”¨ ~rufus 3.2~ æ¯”è¾ƒæ—©æœŸçš„ç‰ˆæœ¬(åæ­£æˆ‘ä¸ªäººçš„ç»éªŒæ˜¯ä¸è¦ç”¨ ~rufus 4.0~ ä¹‹ä¸Šçš„ç‰ˆæœ¬)ï¼Œå¯ä»¥åˆ»å½•iso

æ‰¾ä¸ªæ–°Uç›˜ï¼Œæˆ‘ä¸ªäººä½¿ç”¨çš„æ˜¯ ~2018å¹´åç”Ÿäº§çš„ç¬”è®°æœ¬~ è¿™æ—¶åŸºæœ¬ä¸Šéƒ½å…·å¤‡äº† ~UEFIå¯åŠ¨æ–¹å¼~ æ‰€ä»¥æˆ‘ä¸ªäººä½¿ç”¨çš„æ˜¯ ~GPTã€è€ŒéMBR~ åŒæ—¶è®°å¾—è¦é€‰ç”¨ ~ddæ¨¡å¼~ æ¥åˆ»å½•

ç„¶ååˆ°windowsçš„ ~ç£ç›˜ç®¡ç†~ (ä½¿ç”¨Win+Xå¼¹å‡ºèœå•æ¥é€‰æ‹©ç£ç›˜ç®¡ç†) *æˆ‘ä»¬ä¸€å®šè¦ä¿è¯åˆ†å‡ºæ¥çš„åŒºåŸŸï¼Œåœ¨ [windowsç£ç›˜ç®¡ç†] ä¸­ï¼Œçœ‹ä¸Šå»çš„é¢œè‰²æ˜¯ [é»‘è‰²] çš„æ‰è¡Œ*

ç„¶ååˆ†åŒºåˆ†ä¸ªå¤§æ¦‚100æ¥Gå§ï¼ŒåŸºæœ¬ä¸Šå°±è¶³å¤Ÿäº†ã€‚(æ‚¨è¦åˆ†å¾—å°ä¸€ç‚¹ä¹Ÿå¯ä»¥çš„ï¼Œä½†æœ€èµ·ç ä¿è¯æœ‰30Gçš„ç©ºé—´å°±è¶³å¤Ÿäº†)

ç„¶åæ’Uç›˜ï¼Œæ’ä¸Šå°±è¡Œäº†ï¼Œè¿™æ—¶åœ¨windowsä¸Š ~è‚¯å®šæ˜¯è¯†åˆ«ä¸å‡ºæ¥çš„é‡Œé¢æœ‰ä»€ä¹ˆæ–‡ä»¶~

åˆ«ç®¡ï¼Œæˆ‘ä»¬ ~æŒ‰ä½Shiftï¼Œç„¶åç”¨é¼ æ ‡ç‚¹å‡»Windowsçš„é‡å¯~ ç„¶åå°±ä¼šè¿›å…¥åˆ° ~Windowsç–‘éš¾æ‚ç—‡~ é‚£é‡Œï¼Œç„¶åé€‰æ‹© ~è¿›å…¥å›ºä»¶è®¾ç½®~

ç„¶ååœ¨å›ºä»¶è®¾ç½®é‡Œï¼Œæ‚¨è‡ªå·±å¯»æ‰¾ ~ä½¿ç”¨Uç›˜~ å¯åŠ¨çš„æ–¹å¼ï¼Œå°±å¯ä»¥ ~è¿›å…¥archiso~ äº†

** archisoè¿‡ç¨‹è®°å½•

*** è”ç½‘iwctl

#+begin_src sh  
  # è¿›å…¥interactiveç•Œé¢
  iwctl

  # æŸ¥çœ‹ç¬”è®°æœ¬çš„ç½‘å¡(wlan0)
  device list

  # è®©ç¬”è®°æœ¬ç½‘å¡(wlan0)æ‰«æé™„è¿‘ç½‘ç»œ
  station wlan0 scan

  # è®©ç¬”è®°æœ¬ç½‘å¡(wlan0)è·å–é™„è¿‘ç½‘ç»œ
  station wlan0 get-networks

  # è”ç½‘
  station wlan0 connect ç½‘ç»œ

  # é€€å‡ºiwctl
  exit    
#+end_src

*** åŒæ­¥ç³»ç»Ÿæ—¶é—´

#+begin_src sh
  # è®¾ç½®ç³»ç»Ÿæ—¶é—´
timedatectl set-ntp true
#+end_src


*** fdiskåˆ†åŒº

#+begin_src sh  
  # æŸ¥çœ‹ç¡¬ç›˜åˆ†åŒºæƒ…å†µ(è¿™æ˜¯æˆ‘ä¸ªäººçš„ç¬”è®°æœ¬å”¯ä¸€çš„ä¸€ä¸ªå›ºæ€ç¡¬ç›˜: /dev/sda)
  lsblk

  # æŸ¥çœ‹ç¡¬ç›˜ä¿¡æ¯
  # æˆ‘è¿™é‡Œçš„æƒ…å†µæ˜¯ï¼Œæˆ‘ä¸ä¸€å®šèƒ½ä¿è¯æ‚¨çš„ [ç£ç›˜åç§°] ä¹Ÿæ˜¯ä¸æ˜¯è¿™æ ·ï¼Œå¦‚æœä¸ç¡®å®šçš„è¯ï¼Œè¯·åˆ°ä¸€æ­¥ä¸€æ­¥è·Ÿç€è§†é¢‘æ•™ç¨‹æ¥ https://www.bilibili.com/video/BV1ag411K725
  # + ESPåˆ†åŒº: /dev/sda4
  # + 135GiBç©ºé—´ä¸»åˆ†åŒº: /dev/sda8
  fdisk -l

  # ç„¶åè¿›è¡Œåˆå§‹åŒ–
  # è¿™ä¸€æ­¥å°± [ç›¸å½“äºæ˜¯å°†windowsç£ç›˜ç®¡ç†çš„âš«é»‘è‰²åˆ†åŒºï¼Œåˆå§‹åŒ–ä¸ºwindowsç£ç›˜ç®¡ç†çš„ğŸ”µè“è‰²åˆ†åŒºï¼Œæˆ‘è‡ªå·±å°±æ˜¯å¤§è‡´æè¿°ï¼Œå¸Œæœ›æ‚¨èƒ½ç†è§£åˆ°é‚£ä¸ªæ„æ€å°±è¡Œ]
  fdisk /dev/sda
  # Press n    # n å°±æ˜¯ né”®ï¼Œç”¨æ¥åˆ›å»º(n)ew partition
  # Press RET  # RET å°±æ˜¯ Enteré”®ï¼Œç”¨æ¥æ‰§è¡Œåˆ°ä¸‹ä¸€æ­¥
  # Press RET  # RET å°±æ˜¯ Enteré”®ï¼Œç”¨æ¥æ‰§è¡Œåˆ°ä¸‹ä¸€æ­¥
  # Press RET  # RET å°±æ˜¯ Enteré”®ï¼Œç”¨æ¥æ‰§è¡Œåˆ°ä¸‹ä¸€æ­¥
  # Press w    # w å°±æ˜¯ wé”®ï¼Œç”¨æ¥ä¿å­˜(w)rite

  # ç„¶åç»™æ­¤åˆ†åŒºåŠ ä¸Šç­¾åï¼Œæœ‰ext4ã€zfsã€btrfsç­‰ç­‰
  # æˆ‘ä¸ªäººåªæ¨èä½¿ç”¨ ext4 è€Œä¸å»ºè®®åœ¨éå•†ä¸šå‘è¡Œç‰ˆä¸Šä½¿ç”¨ btrfs (åŸå› æ˜¯éå•†ä¸šç‰ˆçš„btrfsç‚¸äº†æ²¡å¾—ä¿®ï¼Œä¸ªäººä¸ä¼šä¿®btrfså°±è¿™æ ·)
  # /dev/sda8 æ˜¯æˆ‘çš„135GiBç©ºé—´ä¸»åˆ†åŒºï¼Œæˆ‘ä¸ä¸€å®šèƒ½ä¿è¯æ‚¨çš„ [ç£ç›˜åç§°] ä¹Ÿæ˜¯ä¸æ˜¯è¿™æ ·ï¼Œå¦‚æœä¸ç¡®å®šçš„è¯ï¼Œè¯·åˆ°ä¸€æ­¥ä¸€æ­¥è·Ÿç€è§†é¢‘æ•™ç¨‹æ¥ https://www.bilibili.com/video/BV1ag411K725
  mkfs.ext4 /dev/sda8
#+end_src


*** æŒ‚è½½åˆ†åŒº

| åè¯        | åè¯è§£é‡Š                                                                              |
|-------------+--------------------------------------------------------------------------------------|
| ~æŒ‚è½½mount~ | ~åœ¨ä¸€é¢—B+æ–‡ä»¶æ ‘é‡Œé¢ï¼Œå°†ä¸¤ä¸ªæ ‘èŠ‚ç‚¹è¿æ¥èµ·æ¥çš„æ„æ€~ æˆ‘è‡ªå·±å°±æ˜¯å¤§è‡´æè¿°ï¼Œå¸Œæœ›æ‚¨èƒ½ç†è§£åˆ°é‚£ä¸ªæ„æ€å°±è¡Œ  |
| ~æŒ‚è½½åˆ†åŒº~   | ~å°†å­˜æ”¾æ“ä½œç³»ç»Ÿçš„ç£ç›˜ï¼Œæ”¾åœ¨æƒ³è¦æ”¾çš„ä½ç½®è·¯å¾„ç©ºé—´ä¸Š~ æˆ‘è‡ªå·±å°±æ˜¯å¤§è‡´æè¿°ï¼Œå¸Œæœ›æ‚¨èƒ½ç†è§£åˆ°é‚£ä¸ªæ„æ€å°±è¡Œ |

#+begin_src sh  
  # æˆ‘ä¸ä¸€å®šèƒ½ä¿è¯æ‚¨çš„ [ç£ç›˜åç§°] ä¹Ÿæ˜¯ä¸æ˜¯è¿™æ ·ï¼Œå¦‚æœä¸ç¡®å®šçš„è¯ï¼Œè¯·åˆ°ä¸€æ­¥ä¸€æ­¥è·Ÿç€è§†é¢‘æ•™ç¨‹æ¥ https://www.bilibili.com/video/BV1ag411K725  
  # æˆ‘ä¸ä¸€å®šèƒ½ä¿è¯æ‚¨çš„ [ç£ç›˜åç§°] ä¹Ÿæ˜¯ä¸æ˜¯è¿™æ ·ï¼Œå¦‚æœä¸ç¡®å®šçš„è¯ï¼Œè¯·åˆ°ä¸€æ­¥ä¸€æ­¥è·Ÿç€è§†é¢‘æ•™ç¨‹æ¥ https://www.bilibili.com/video/BV1ag411K725
  # æˆ‘ä¸ä¸€å®šèƒ½ä¿è¯æ‚¨çš„ [ç£ç›˜åç§°] ä¹Ÿæ˜¯ä¸æ˜¯è¿™æ ·ï¼Œå¦‚æœä¸ç¡®å®šçš„è¯ï¼Œè¯·åˆ°ä¸€æ­¥ä¸€æ­¥è·Ÿç€è§†é¢‘æ•™ç¨‹æ¥ https://www.bilibili.com/video/BV1ag411K725

  # æŒ‚è½½ä¸»åˆ†åŒº           (æˆ‘çš„ç¬”è®°æœ¬æ˜¯/dev/sda8)åˆ°/mnt
  mount /dev/sda8 /mnt

  # æŒ‚è½½EFI Systemåˆ†åŒº   (æˆ‘çš„ç¬”è®°æœ¬æ˜¯/dev/sda4)åˆ°/mnt/boot	(UEFIå¯åŠ¨)
  mkdir /mnt/boot
  mount /dev/sda4 /mnt/boot	# æ­£æ˜¯ç”±äºè¿™é‡Œï¼Œæ‰€ä»¥ä¼šé‡åˆ°åé¢çš„ESPå¤§å°å®¹é‡ä¸å¤Ÿå¯¼è‡´çš„ä¸€ä¸ªå°é—®é¢˜: grub error: no left space to create a directory.
#+end_src


*** è®¾ç½®é•œåƒæºmirrorlist

#+begin_src sh  
  # ä½¿ç”¨vimæ‰“å¼€mirrorlist
  vim /etc/pacman.d/mirrorlist

  # å¹¶æ·»åŠ æœåŠ¡å™¨é•œåƒ
  Server = https://mirrors.ustc.edu.cn/archlinux/$repo/os/$arch  # ä¸­ç§‘å¤§
  Server = https://mirrors.bfsu.edu.cn/archlinux/$repo/os/$arch  # åŒ—äº¬å¤–å›½è¯­å¤§å­¦(å¹¿åº¦ä¼˜å…ˆæœç´¢å¤§å­¦ï¼Œæ¢—æ¥è‡ªæ¸…åæº4æœˆ1æ—¥æ„šäººèŠ‚)
#+end_src


*** pacstrapå®‰è£…å¿…è¦çš„è½¯ä»¶

#+begin_src sh
  # ä½œç”¨: è®© pacstrapè£…ä¿®å¸ˆå‚… å¯¹ç€ /mnt è¿™ä¸ªæ–°å®¶ï¼Œè¿›è¡Œè£…ä¿®(å®‰è£…è½¯ä»¶)
  # å†…æ ¸: linux-lts(ç¨³å®šç‰ˆ)
  pacstrap /mnt base base-devel linux-lts linux-firmware dhcpcd
#+end_src


*** ç”Ÿæˆfstab

#+begin_src sh  
  # ç”Ÿæˆfstab
  genfstab -L /mnt >> /mnt/etc/fstab

  # æŸ¥çœ‹(æˆ‘çš„ç¬”è®°æœ¬)æƒ…å†µ
  # /dev/sda8   =>   /	   btrfs
  # /dev/sda4   =>   /boot   vfat
  cat /mnt/etc/fstab
#+end_src


*** æ¬å®¶arch-chroot

#+begin_src sh  
  # ä½œç”¨: æŠŠè‡ªå·±æ¬è¿›äº†æ¯›èƒšæˆ¿æ–°å®¶(æ­¤æ—¶çš„/mntæ–°å®¶ï¼Œè¿˜æ˜¯åˆšè£…ä¿®å®Œï¼Œè£…ä¿®å¸ˆå‚…æ²¡æœ‰æ‰“æ‰«å«ç”Ÿï¼Œè‡ªå·±çš„è¡Œæè¿˜æ²¡æ”¾ç½®è¿›å»)
  arch-chroot /mnt

  # æ•ˆæœ
  # root@archiso ~#   ä¼šæ”¹æˆ   [root@archiso /]#
#+end_src


*** è®¾ç½®ç³»ç»Ÿæ—¶åŒºæ—¶é—´

#+begin_src sh  
  # è®¾ç½®æ—¶é—´åŒºåŸŸä¸ºäºšæ´²/ä¸Šæµ·(Asia/Shanghai)
  ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
#+end_src


*** åŒæ­¥æ—¶é—´ä¸ºç¡¬ä»¶æ—¶é—´

#+begin_src sh  
  # hwclock  
  hwclock --systohc
#+end_src


*** å®‰è£…ä¸€äº›è½¯ä»¶

#+begin_src sh  
  # vimåœ¨å¿«é€Ÿç¼–è¾‘ä¸€äº›æ–‡ä»¶è¿˜æ˜¯å¾ˆæœ‰ç”¨æ­¦ä¹‹åœ°çš„ï¼Œè¿˜æ˜¯ååˆ†æ¨èå®‰è£…vim.....
  pacman -S vim dialog wpa_supplicant ntfs-3g networkmanager netctl
#+end_src


*** è®¾ç½®æœ¬æœºç¯å¢ƒ

#+begin_src sh
# è®¾ç½®è¯­è¨€
# #en_US.UTF-8 UTF-8   æ”¹æˆ   en_US.UTF-8 UTF-8
# #zh_CN.UTF-8 UTF-8   æ”¹æˆ   zh_CN.UTF-8 UTF-8
# #zh_TW.UTF-8 UTF-8   æ”¹æˆ   zh_TW.UTF-8 UTF-8
# #zh_HK.UTF-8 UTF-8   æ”¹æˆ   zh_HK.UTF-8 UTF-8
vim /etc/locale.gen

# ç”Ÿæˆè¯­è¨€é¡¹
locale-gen

# è®¾ç½®ç³»ç»Ÿç¯å¢ƒè¯­è¨€
# æ·»åŠ  LANG=en_US.UTF-8
vim /etc/locale.conf

# è®¾ç½®ä¸»æœºå( ä¸»æœºå è¦è®°ä½)
# æ·»åŠ  kle(æˆ–è€…ä½ è‡ªå·±è®¾ç½®ä¸€ä¸ªåç§°ï¼Œæ¯”å¦‚æˆ‘è¿™é‡Œè®¾ç½®kleï¼Œåé¢å°±è¦ç”¨åˆ°kle)
vim /etc/hostname

# æ¿€æ´»ä¸»æœºå
# 127.0.0.1 localhost
# ::1 localhost
# 127.0.1.1 kle.localdomain kle  (kleæ˜¯æˆ‘è‡ªå·±çš„ [ä¸»æœºå])
vim /etc/hosts

# è®¾ç½®rootå¯†ç 
passwd
#+end_src


*** è®¾ç½®(B)oot(L)oader

#+begin_src sh
  # ä¸å¼„ä¼šæ€æ ·ï¼Ÿé‚£å°±æ²¡æœ‰ â€œé’¥åŒ™â€
  # å¯¼è‡´å¯¼è‡´ç³»ç»Ÿçš„ç¡®æ˜¯å®‰è£…åœ¨ç¡¬ç›˜ä¸Šäº†ï¼Œä½†å°±æ˜¯è¿›ä¸å»ï¼Œå› ä¸ºæ²¡æœ‰ â€œé’¥åŒ™â€
  # è£…äº†ä¹Ÿæ˜¯ç™½è£…ï¼Œä¸‹ä¸€æ¬¡è¿›ç³»ç»Ÿè¿˜æ˜¯Windows (å³ä½¿æ‚¨è¿›å…¥äº†bioså›ºä»¶è®¾ç½®ï¼Œä»ç„¶åªä¼šæ‰¾åˆ°windowsçš„å¼•å¯¼æ–‡ä»¶)
  # bootloaderä½œç”¨: é€šè¿‡BLè¿™ç±»ç¨‹åºï¼Œæ¥è®©ç¡¬ä»¶é©±åŠ¨è½¯ä»¶èµ·æ¥ï¼Œè®©è½¯ä»¶è·‘èµ·æ¥(è¿™é‡Œçš„è½¯ä»¶æŒ‡çš„æ˜¯æ“ä½œç³»ç»Ÿ)

  # å®‰è£…os-proberï¼Œä¸ºäº†å®‰è£…è®©archlinuxä¸windows10åŒç³»ç»Ÿå…±å­˜
  # ä¸æ—¶ä¿±è¿›: å¥½åƒè¯´ä¸ç”¨è£…è¿™ä¸ªäº†ï¼Œä½†ä¸ºäº†ä»¥é˜²ä¸‡ä¸€è¿˜æ˜¯è£…ä¸Šå§ï¼
  pacman -S os-prober ntfs-3g
  pacman -S grub efibootmgr

  # ä½¿ç”¨grubï¼Œä»è€Œåœ¨/bootä¸‹ï¼Œç”Ÿæˆåä¸ºgrubçš„å¼•å¯¼æ–‡ä»¶
  grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=grub

  # grub-mkconfig è¾“å‡ºç”Ÿæˆgrubé…ç½®æ–‡ä»¶(æ­¤æ—¶ç¯å¢ƒ: Uç›˜é‡Œé¢ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯åªæœ‰ [archlinux] è¯¥ â€œè½¯ä»¶â€ (è¿™é‡Œçš„è½¯ä»¶æŒ‡çš„æ˜¯æ“ä½œç³»ç»Ÿ))
  cd /boot && mkdir grub
  cd ../
  grub-mkconfig -o /boot/grub/grub.cfg
#+end_src


*** å‡†å¤‡æ‹”Uç›˜

#+begin_src sh
  exit
  # æ•ˆæœ
  # [root@archiso /]#   ä¼šæ”¹æˆ   root@archiso ~#

  # é‡å¯ï¼Œé»‘å±äº†å°±æ‹”uç›˜ï¼Œé˜²æ­¢äºŒæ¬¡è¿›å…¥archiso(è¿™å¾—çœ‹ä¸»æ¿é‚£æ—¶çš„è®¾ç½®)  
  reboot

  # å¤‡æ³¨
  # + å¦‚æœæ‚¨å‡ºå…ˆäº† "watchdog did not stop" çš„æç¤ºï¼Œæœ€å¥½ç­‰å¾…ä¸ª10æ¥åˆ†é’Ÿå·¦å³ï¼Œä¸è¦æ‹”Uç›˜ï¼Œç­‰å¾…äº†10åˆ†é’Ÿä¹‹åç›´æ¥ç¡¬ä»¶å…³æœºç„¶åå†æ‹”Uç›˜ä¸ç„¶è£…ä¸ä¸Šçš„ï¼Œå¦‚æœå‡ºç°äº†å¹¶å¼ºè¡Œæ‹”ä¸‹æ¥çš„è¯éœ€è¦é‡è£…ä»è¿™å¥è¯ä¹‹ä¸Šé¢çš„æ¯ä¸€æ­¥ã€‚
  # + åæ­£æˆ‘è‡ªå·±2024å¹´4æœˆä»½å®‰è£…çš„æ—¶å€™ï¼Œåœ¨æˆ‘è‡ªå·±è¿™å°ç¬”è®°æœ¬ä¸Šæ˜¯è¿™æ ·çš„
  # + ä½†æ˜¯ç°åœ¨2024å¹´10æœˆ1æ—¥çš„é•œåƒä¸ç”¨ç­‰äº†ï¼Œç›´æ¥å½“ç”µè„‘é»‘å±å°±èƒ½ç›´æ¥æ‹”Uç›˜äº†ã€‚

  # OK
  # + å¦‚æœæ‚¨æ‹”äº†Uç›˜ä¹‹åï¼Œä¸€èˆ¬æ¥è¯´å°±ä¼šè¿›å…¥åˆ° [å…¨æ–°å®‰è£…å¥½çš„ArchLinuxäº†]
  # + ç„¶åæˆ‘ä»¬åœ¨ttyä¸Šç™»é™†
  # + è¾“å…¥ "root" å­—ç¬¦
  # + è¾“å…¥ "æ‚¨åˆšåˆšæ‚¨è‡ªå·±è®¾ç½®è¿‡çš„å¯†ç " (å¯†ç ä¸ä¼šå›æ˜¾çš„)
#+end_src

** å·²å®‰è£…å¥½archlinuxåçš„æœ¬æœºè®¾ç½®
*** è”ç½‘

#+begin_src sh
  # ç½‘ç»œè¿æ¥
  # é¦–å…ˆï¼Œæ— è®ºæœ‰çº¿æ— çº¿ç½‘ç»œè¿æ¥ï¼Œéƒ½å¿…é¡»å…ˆå¼€å¯æœåŠ¡
  systemctl enable NetworkManager
  systemctl start NetworkManager
  
  # å¦‚æœæœºå™¨æ˜¯æœ‰çº¿ç½‘çº¿è¿æ¥: å°±å·²ç»è¿ä¸Šç½‘äº†
  # å¦‚æœæœºå™¨æ˜¯æ— çº¿è¿æ¥: å¿…é¡»è¿›è¡Œä¸‹é¢çš„æ­¥éª¤

  # æ— çº¿è”ç½‘(å¦‚æœæ˜¯æœ‰çº¿çš„è¯ï¼Œåœ¨å¼€å¯ä¸Šé¢çš„æœåŠ¡åå°±å¯ä»¥ç›´æ¥è”ç½‘äº†)
  nmcli dev wifi list
  nmcli dev wifi connect "ç½‘ç»œå" password "å¯†ç "
#+end_src

*** è®¾ç½®SWAPäº¤æ¢åˆ†åŒº

#+begin_src sh

  # è®¾ç½®SWAPåˆ†åŒº
  # æœ‰äººè¯„ä»·è¯´ï¼Œå¯¹äºSWAPåˆ†åŒºå¤§å°çš„æœ€ä½³é€‰æ‹©ï¼Œæ˜¯ [SWAPå¤§å° ğŸŸ° çœŸå®å†…å­˜å¤§å° â— 2]ï¼Œä¸è¿‡ä¸ªäººè®¤ä¸ºè§ä»è§æ™ºï¼Œæˆ‘ä¸ªäººç¬”è®°æœ¬å†…å­˜å…±æœ‰8Gï¼Œä»…è®¾ç½®äº†2Gçš„SWAPåˆ†åŒº
  
  # è¿™é‡Œåœ¨ "/" ç›®å½•ä¸‹ï¼Œè®¾ç½®äº†2G(2048M)å¤§å°çš„SWAPåˆ†åŒº
  dd if=/dev/zero of=/swapfile bs=1M count=2048 status=progress
  chmod 600 /swapfile
  mkswap /swapfile
  swapon /swapfile

  # æ‰‹æ“ä¸€ä¸‹fstabï¼Œæ¥å¼€å¯SWAP
  vim /etc/fstab

  # ä½¿ç”¨vimæ¥æ·»åŠ ä¸‹é¢çš„æ–‡æœ¬
  /swapfile     none    swap      defaults                0 0
#+end_src


*** åˆ›å»ºæ—¥å¸¸ä½¿ç”¨çš„ç”¨æˆ·ï¼Œè€Œä¸æ˜¯rootç”¨æˆ·

#+begin_src sh
   # æˆ‘çš„æ—¥ç”¨ç”¨æˆ·åæ˜¯: kle
   useradd -m -G wheel kle

   # ç„¶åç¬¬1æ¬¡è¾“å…¥ æ—¥ç”¨ç”¨æˆ·åçš„å¯†ç 
   # ç„¶åç¬¬2æ¬¡è¾“å…¥ æ—¥ç”¨ç”¨æˆ·åçš„å¯†ç 
   passwd æ—¥ç”¨ç”¨æˆ·å

   # å®‰è£…sudo
   pacman -S sudo
   
   # ç¼–è¾‘å™¨è®¾ç½®ï¼Œå°†viæ˜ å°„æˆäº†vimï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸ºäº†ç”¨visudo
   # å¦‚æœä¸æƒ³æ˜ å°„çš„è¯ï¼Œæ‰§è¡Œ sudo vim /etc/sudoers ä¹Ÿæ˜¯å¯ä»¥çš„
   ln -s /usr/bin/vim /usr/bin/vi
   
   # ç¼–è¾‘è¿›è¡Œä¸‹é¢çš„ä¿®æ”¹
   visudo
   #%wheel ALL=(ALL:ALL) ALL   æ”¹æˆ   %wheel ALL=(ALL:ALL) ALL
   
   # åˆ‡æ¢åˆ°æ—¥ç”¨ç”¨æˆ·åï¼Œå¹¶ä¸”é€šè¿‡suï¼Œæ¥ç»™äºˆrootæƒé™ (æˆ‘è‡ªå·±çš„æ—¥ç”¨ç”¨æˆ·åæ˜¯: kle)
   su kle  
#+end_src

*** å®‰è£…æ¡Œé¢ç¯å¢ƒDE

#+begin_src sh
  # å¼€å¯ä¸€äº›å¯ç”¨ä»“åº“æº
  # #[multilib]                         æ”¹æˆ   [multilib]
  # #include=/etc/pacman.d/mirrorlist   æ”¹æˆ   include=/etc/pacman.d/mirrorlist
  #                                     æ”¹æˆ   [archlinuxcn]					
  #                                     æ”¹æˆ   Server = https://repo.archlinuxcn.org/$arch
  sudo vim /etc/pacman.conf

  # å¼ºåˆ¶å¼€æ»šï¼Œä¿æŒä¸é•œåƒæºçš„åŒæ­¥
  sudo pacman -Syy

  # archlinuxcnçš„å¯†é’¥ç¯
  # + å¥½åƒæ˜¯å› ä¸ºäººæ‰‹ä¸å¤Ÿï¼Œåˆ é™¤äº†ä¸€ä¸ªmaster key
  # + å¯¼è‡´fcæ•™æˆçš„å¯ä¿¡ç¨‹åº¦è®¾ç½®åˆ°marginal trustå¯¼è‡´çš„
  # + ç°åœ¨æ‰‹åŠ¨è¦ä¿¡ä»»sudo pacman -Syyåå­˜åœ¨æœºå™¨æœ¬åœ°çš„fcæ•™æˆfarseerfcçš„å¯†é’¥
  sudo pacman-key --lsign-key "farseerfc@archlinux.org"
  # è¿™ä¸€æ­¥çš„é’©å­å‡½æ•°è¿è¡Œæ—¶é—´ï¼Œè¾ƒé•¿ï¼Œå› ä¸ºå®ƒè¦ç»™æ‰€æœ‰æœ¬åœ°çš„åŒ…åŠ ä¸Šåˆšå¯¼å…¥çš„fcæ•™æˆçš„ç­¾åï¼Œé™é™ç­‰å¾…å°±å¥½ã€‚
  sudo pacman -S archlinuxcn-keyring

  # æ˜¾å¡é©±åŠ¨
  # æ¨èèµ„æ–™: https://wiki.archlinuxcn.org/wiki/Xorg#%E5%AE%89%E8%A3%85
  # + æ¯”å¦‚åœ¨æˆ‘ä¸ªäººçš„ç¬”è®°æœ¬ä¸Šï¼Œä¸è¦å®‰è£…è¿™ä¸ªxf86-intel-videoï¼Œå¦åˆ™å°†ä¼šå¯¼è‡´sddmç™»å½•ç•Œé¢èŠ±å±é—ªçƒ
  # + å¯¼è‡´æ°¸è¿œæ— æ³•é€šè¿‡sddmåˆ‡æ¢å…¶ä½™çš„æ¡Œé¢ç¯å¢ƒ(ä½†æ˜¯ç›²è¾“å¯†ç æ˜¯å¯ä»¥ç™»å½•KDE plasma on Waylandçš„)
  # + ä¸å®‰è£…xf86-video-intelæ—¶ï¼Œä¼šé»˜è®¤ä½¿ç”¨è‡ªå¸¦çš„Xorgçš„modesettingã€‚
  # + mesaæ˜¯OpenGLæ­¤é©±åŠ¨
  sudo pacman -S mesa

  # å®‰è£…ç•Œé¢ç¾è§‚ã€ä¸”é…ç½®ç°ä»£çš„KDE(åŒæ—¶ä½¿ç”¨SDDMæ¡Œé¢ç®¡ç†å™¨)
  sudo pacman -S xorg plasma kde-applications sddm network-manager-applet
  # + ç„¶åä¸€ç›´RET(Enter)ä¸‹å»å°±è¡Œäº†ï¼ŒæŒ‰ä¸ªå¤§æ¦‚10æ¥æ¬¡éƒ½ç¡®å®šå°±è¡Œäº†
  # + å› ä¸º https://www.bilibili.com/video/BV1ag411K725 è§†é¢‘æ•™ç¨‹ä¹Ÿæ˜¯å…¨éƒ¨ç¡®å®šçš„


  
  # åœ¨çº¦åŠå°æ—¶åçš„ä¸‹è½½å¹¶å®‰è£…å®Œæ¯•ä¹‹åï¼Œæ‰“å¼€æ¡Œé¢ç®¡ç†å™¨sddm
  sudo sytemctl enable sddm

  # å…³é—­ä¸€äº›æœåŠ¡
  sudo systemctl disable netctl

  # å¼€å¯ç½‘ç»œæœåŠ¡ï¼Œä»è€Œå¯ä»¥åœ¨ä¸‹ä¸€æ¬¡çš„æ¯æ¬¡è¿›ç³»ç»Ÿéƒ½èƒ½ä½¿ç”¨è”ç½‘åŠŸèƒ½
  sudo systemctl enable NetworkManager  
#+end_src


*** å®‰è£…ä¸­æ–‡å­—ä½“

#+begin_src sh
  # å®‰è£…ä¸­æ–‡å­—ä½“
  sudo pacman -S wqy-microhei wqy-microhei-lite wqy-bitmapfont wqy-zenhei ttf-arphic-ukai ttf-arphic-uming adobe-source-han-sans-cn-fonts noto-fonts-cjk
#+end_src


*** é‡æ–°è®¾ç½®æœ¬æœºè¯­è¨€

#+begin_src sh  
  # é‡æ–°è®¾ç½®æœ¬æœºè¯­è¨€
  sudo vim /etc/locale.conf
  # #LANG=en_US.UTF-8   æ”¹æˆ   LANG=zh_CN.UTF-8
#+end_src


*** å¤ªç¾ä¸½å•¦KDE

#+begin_src sh
sudo reboot
#+end_src


** ä¸€äº›ä¹Ÿè®¸æœ‰ç”¨çš„è½¯ä»¶

*** ä¸­æ–‡è¾“å…¥æ³•fcitx5

#+begin_src sh
  # å®‰è£…fcitx5å…¨å®¶æ¡¶
  # + fcitx5-im  æœ¬ä½“
  # + fcitx5-chinese-addons è¾“å…¥ä¸­æ–‡é™„åŠ é¡¹
  # + fcitx5-material-color Materialä¸»é¢˜è‰²  
  sudo pacman -S fcitx5-im fcitx5-chinese-addons fcitx5-material-color

  # åœ¨ç›¸åº”çš„å›¾å½¢ç¯å¢ƒä¹‹ä¸‹çš„è½¯ä»¶çš„IMè½¯ä»¶ï¼Œå‡å¯ä½¿ç”¨fcitx5å…¨å®¶æ¡¶ã€‚æ¯”å¦‚æˆ‘æƒ³åœ¨spectacle(KDEçš„æˆªå›¾å·¥å…·ï¼Œå±äºQT_IM_MODULE)è¾“å…¥ä¸­æ–‡ï¼Œäºæ˜¯å°±è®¾ç½®QT_IM_MODULE=fcitx
  #       æ”¹æˆ      GTK_IM_MODULE=fcitx
  #       æ”¹æˆ      QT_IM_MODULE=fcitx
  #       æ”¹æˆ      XMODIFIERS=@im=fcitx
  #       æ”¹æˆ      SDL_IM_MODULE=fcitx
  sudo vim /etc/environment

  # åœ¨KDEä¸‹ï¼Œéœ€è¦åˆ° [ç³»ç»Ÿè®¾ç½® > é”®ç›˜ > è™šæ‹Ÿé”®ç›˜ > é€‰æ‹© "Fcitx5" (è€Œä¸æ˜¯ "Fcitx5 Waylandå¯åŠ¨å™¨(å®.."))]
  # ä»è€Œæ¥è®©KDEæ¡Œé¢ç¯å¢ƒï¼Œè¯†åˆ«å‡ºfcitx5ã€‚ä»è€Œè‡ªå·±åœ¨send-keyæ—¶ï¼Œèƒ½å‘C-SPCåˆ°KDE on Waylandä¸Šï¼Œè¿›è¡Œåˆ‡æ¢è¾“å…¥æ³•  
#+end_src


*** ç”µæ± å……ç”µé˜ˆå€¼(å¯é€‰)

#+begin_src sh
  # ç”µæ± å……ç”µé˜ˆå€¼
  # + æ­¤åŠŸèƒ½çš„å¼€å¯ï¼Œä¸ä¾èµ–ä»»ä½•ç³»ç»Ÿï¼Œå…·ä½“éœ€è¦çœ‹å‚å•†çš„ç¡¬ä»¶æ”¯æŒ
  # + å¯åˆ°ç¬”è®°æœ¬çš„ç›¸åº”é—¨æˆ·ç½‘ç«™ä¸ŠæŸ¥è¯¢æ‰‹å†ŒæŸ¥çœ‹æ˜¯å¦æœ‰è¿™ä¸€åŠŸèƒ½
  # + æ¯”å¦‚æ—©æœŸä¸€ç‚¹ç‚¹çš„ä¸€äº›TPç¬”è®°æœ¬ï¼Œæ”¯æŒå……ç”µåˆ°60%æˆ–å……ç”µåˆ°80%è¿™2ä¸ªå›ºå®šçš„å€¼
  # + æ¯”å¦‚ä¸€äº›ASUSç¬”è®°æœ¬ï¼Œæ”¯æŒ60%åˆ°100%çš„80ä¸ªå›ºå®šçš„å€¼(è¿™æˆ‘è‡ªå·±çœŸçš„æ²¡æƒ³åˆ°æ”¯æŒæ€ä¹ˆè¿™ä¹ˆå¥½ï¼Ÿ)

  # å®‰è£…ç”µæ± å……ç”µé˜ˆå€¼
  sudo pacman -S tlp

  # åœæ­¢ç°æœ‰çš„ç”µæ± å……ç”µé˜ˆå€¼æœåŠ¡
  sudo systemctl disable tlp
  sudo systemctl stop tlp

  # æˆ‘è‡ªå·±è¿™é‡Œæ˜¯å½“å……ç”µå°‘äº75%å°±å¼€å§‹å……ç”µï¼Œå……ç”µåˆ°80%å°±åœä¸‹ã€‚
  sudo vim /etc/tlp.conf
  # #START_CHARGE_THRESH_BAT0=75   æ”¹æˆ   START_CHARGE_THRESH_BAT0=75
  # #STOP_CHARGE_THRESH_BAT0=80    æ”¹æˆ   STOP_CHARGE_THRESH_BAT0=80

  # å¼€å¯æœ€æ–°çš„ç”µæ± å……ç”µé˜ˆå€¼æœåŠ¡
  sudo systemctl enable tlp  
#+end_src

*** Xä¸Wayland(å¯é€‰)

| æ¡Œé¢æœåŠ¡å™¨(æ¡Œé¢åè®®) | æ®æˆ‘ä¸ªäººæ‰€çŸ¥çš„DE                                                                       | æ®æˆ‘ä¸ªäººæ‰€çŸ¥çš„WM       |
|--------------------+--------------------------------------------------------------------------------------+----------------------|
| X                  | æœ€ç¨³å®šçš„æ¡Œé¢æœåŠ¡å™¨ï¼Œ2024å¹´æœ‰å¼€å‘è€… ~Enrico Weigelt~ ä¸€äººä¹‹åŠ›æäº¤æ•°å åˆ°äº† 83%                | i3wmã€dwm, etc.      |
| Wayland            | æµè¡Œåº¦å¾ˆé«˜çš„æ¡Œé¢æœåŠ¡å™¨ï¼Œè¯´æ˜¯Waylandé‡æ–°å®ç°å¹¶æŠ½è±¡äº†Xæ¡Œé¢åè®®ï¼Œå¹¶å®ç°äº†Xæ²¡æœ‰çš„åŠŸèƒ½æ¯”å¦‚ â€œå€æ•°ç¼©æ”¾â€ | Hyprlandã€NIRI, etc. |
| XWayland           | X ä¸ Wayland ä¹‹é—´çš„æ¡¥æ¢ï¼Œä»è€Œåœ¨Waylandä¸‹è¿è¡Œåªéµå¾ªXæ¡Œé¢åè®®çš„è½¯ä»¶ï¼Œæ¯”å¦‚ alacritty           | N/A                  |

æ‰€ä»¥ï¼Œè¦åœ¨Waylandä¸‹è¿è¡Œåªéµå¾ªXæ¡Œé¢åè®®çš„è½¯ä»¶ï¼Œæ¯”å¦‚åœ¨Waylandä¸‹è¿è¡Œalacrittyçš„è¯ï¼Œå°±éœ€è¦è¿™æ ·
#+begin_src sh
  # è¦åœ¨Waylandä¸‹è¿è¡Œåªéµå¾ªXæ¡Œé¢åè®®çš„è½¯ä»¶ï¼Œæ¯”å¦‚åœ¨Waylandä¸‹è¿è¡Œalacrittyçš„è¯ï¼Œå°±éœ€è¦è¿™æ ·  
  sudo vim /etc/environment

  # alacritty
  #      æ”¹æˆ      WINIT_UNIX_BACKEND=x11 alacritty

  # kitty
  #      æ”¹æˆ      WINIT_UNIX_BACKEND=x11 kitty  
#+end_src


*** å­—ä½“è¡¥ä¸(å¯é€‰)

è¿™é‡Œçš„å­—ä½“è¡¥ä¸ï¼Œä¸“é—¨æŒ‡ä¸º ~Nerd Font~ å­—ä½“æ‰“ä¸Š ~fontforge~ è¡¥ä¸ï¼Œfontforgeè„šæœ¬(å­—ä½“è¡¥ä¸)ï¼Œçš„å®ç°æ¥è‡ªäº [[https://github.com/ryanoasis][nfå­—ä½“ä½œè€…: ryanoasis]]

æˆ‘è‡ªå·±ä½¿ç”¨çš„æ˜¯ï¼Œä»nfå­—ä½“ä½œè€…ryanoasisçš„ä»“åº“ç¿»å‡ºæ¥çš„ä¸€ä¸ªå­—ä½“ï¼Œæ˜¯ ~SourceCodeProå­—ä½“ + NFå›¾æ ‡~ åçš„å­—ä½“
#+begin_src sh
  # å®‰è£…fontforge
  sudo pacman -S fontforge  

  # ä¸‹è½½å­—ä½“(åŸå§‹åç§°: 'Sauce Code Pro Semibold Nerd Font Complete Mono.ttf')
  # https://github.com/colfwe/dotfiles/tree/main/res/fonts(ä»“åº“åœ°å€)

  # ä¸‹è½½fontforgeè„šæœ¬(å­—ä½“è¡¥ä¸)
  # https://github.com/ryanoasis/nerd-fonts?tab=readme-ov-file#font-patcher(ä»“åº“åœ°å€çš„archiveæ­¤å¤„)

  # æ‰“å­—ä½“è¡¥ä¸(è¡¥ä¸åçš„åç§°: SauceCodeProNerdFontCompleteMonoNerdFont-SemiBold.ttf)
  # fontforge --script ./font-patcher --complete 'Sauce Code Pro Semibold Nerd Font Complete Mono.ttf'

  # å®‰è£…å­—ä½“
  mkdir -p ~/.local/share/fonts/
  mv SauceCodeProNerdFontCompleteMonoNerdFont-SemiBold.ttf ~/.local/share/fonts/
  sudo fc-cache -f
#+end_src


*** åŒ…é™çº§è½¯ä»¶(å¯é€‰)

æä¾›å‘½ä»¤è¡ŒTUIç•Œé¢ï¼Œç”¨æ¥è¿›è¡Œåœ¨æŸæ¬¡pacman -Syuåï¼Œé™çº§æŸä¸ªç‰¹å®šè½¯ä»¶åŒ…

#+begin_src sh
  # æä¾›å‘½ä»¤è¡ŒTUIç•Œé¢ï¼Œç”¨æ¥è¿›è¡Œåœ¨æŸæ¬¡pacman -Syuåï¼Œé™çº§æŸä¸ªç‰¹å®šè½¯ä»¶åŒ…
  sudo pacman -S downgrade
#+end_src

