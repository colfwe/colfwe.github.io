<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-06-11 Wed 01:55 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="author" content="kle" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="content" class="content">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org6d799c2">1. 【猎奇行为】在Windows11-WSL上使用emacs-feature-igc-31050-包括libmps包括libgccjit</a>
<ul>
<li><a href="#org48bbb0b">1.1. 无图言雕是吧</a></li>
<li><a href="#orga69ecc6">1.2. 原因</a></li>
<li><a href="#org7a2cb24">1.3. 方案</a>
<ul>
<li><a href="#orgad47014">1.3.1. 方案1 - WSLg(Win11用户的选择，强烈推荐！！)</a></li>
<li><a href="#org1410ea8">1.3.2. 方案2 - MSYS2(Win10用户的选择)</a></li>
<li><a href="#orge7d77f6">1.3.3. 方案2 - WSL + X Server(Win10用户的选择)</a></li>
<li><a href="#orgab9acd9">1.3.4. 方案3 - GNU FTP main Server</a></li>
</ul>
</li>
<li><a href="#org8dd1efc">1.4. 转发fc教授的一句话</a></li>
<li><a href="#org964dcd9">1.5. 个人暴论时刻</a>
<ul>
<li><a href="#orgea05179">1.5.1. 【个人暴论】WSL+WSLg只适合GUI应用，不太适合CLI应用</a></li>
<li><a href="#org221e96e">1.5.2. 【个人暴论】你说我什么时候会回到linux啊？</a></li>
</ul>
</li>
<li><a href="#orgb925461">1.6. 一些问题</a>
<ul>
<li><a href="#org7bf9872">1.6.1. 【闲谈】emacs-rime 的 posframe 会很卡很卡</a></li>
<li><a href="#orgefff1b2">1.6.2. 【闲谈】WSL环境问题: 我当时还需要这样做的，现在不需要了</a></li>
</ul>
</li>
<li><a href="#orga90d2c6">1.7. 一些感受</a>
<ul>
<li><a href="#orge0979db">1.7.1. 20250610</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-org6d799c2" class="outline-2">
<h2 id="org6d799c2"><span class="section-number-2">1.</span> 【猎奇行为】在Windows11-WSL上使用emacs-feature-igc-31050-包括libmps包括libgccjit</h2>
<div class="outline-text-2" id="text-1">
<p>
<b>伟大无需多言</b>
</p>

<blockquote>
<p>
现在，在 ArchLinux Dev 与 软软Windows工作人员，的共同努力下，现在的 Windows11 真的成为了 Linux最佳发行版（个人观点）
</p>

<p>
不过我这个比喻就像是在描述 GNU Emacs 是最伟大的编辑器一样: 哪里有一个生产数据可脚本化的地方，GNU Emacs的大手就伸到哪里。
</p>
</blockquote>

<p>
<b>打破刻板印象了(对我个人来说)</b>
</p>

<blockquote>
<p>
过去，Windows 给人的刻板印象是: 现代又好用的智能家具，但不允许用户改动一丝。
</p>

<p>
现在，Windows 11(WSL+WSLg) 给人的船新感受是: 现代又好用的智能家具，贼省心，用户可以随便魔改，就像我下面这个猎奇需求一样。
</p>

<p>
暴论一句: 如果用不顺心了，还可以甩锅甩给 WSL 不是嘛 <code>o(≧▽≦)o</code>
</p>

<p>
但 BYD 现在这个事情真的很爽！这下的兼容性是真tm牛逼！
</p>
</blockquote>

<p>
感谢 GNU
</p>

<p>
感谢 ArchLinux Dev
</p>

<p>
感谢软软 Windows 工作人员
</p>
</div>
<div id="outline-container-org48bbb0b" class="outline-3">
<h3 id="org48bbb0b"><span class="section-number-3">1.1.</span> 无图言雕是吧</h3>
<div class="outline-text-3" id="text-1-1">

<div id="org5b7c2e6" class="figure">
<p><img src="../res/无图言雕是吧1.png" alt="无图言雕是吧1.png" width="720px" />
</p>
</div>


<div id="org2949ff6" class="figure">
<p><img src="../res/无图言雕是吧2.png" alt="无图言雕是吧2.png" width="720px" />
</p>
</div>


<div id="orgcaaf92c" class="figure">
<p><img src="../res/无图言雕是吧3.png" alt="无图言雕是吧3.png" width="720px" />
</p>
</div>
</div>
</div>
<div id="outline-container-orga69ecc6" class="outline-3">
<h3 id="orga69ecc6"><span class="section-number-3">1.2.</span> 原因</h3>
<div class="outline-text-3" id="text-1-2">
<p>
为什么要这么猎奇，非得要在Windows11上运行emacs-feature-igc？
</p>

<blockquote>
<p>
[简单来说]
</p>
<ul class="org-ul">
<li>破烂笔记本，不值得折腾</li>
<li>为了Emacs而使用Linux</li>
<li>WSL-archlinux有arch官方支持，更有保障了</li>
<li>打游戏</li>
<li>心累了</li>
</ul>

<p>
[详细来说]
</p>

<ul class="org-ul">
<li><p>
破烂笔记本，不值得折腾
</p>

<p>
因为我自己的笔记本过于垃圾，即使我买来一些外设来弥补相差的体验，但它那台破烂笔记本仍然就是那个破烂样。
</p>

<p>
我可以保证说，在同样的外部环境下，安装同样的系统，我的笔记本报出的错误，绝对比任何人的设备都要多。
</p>

<p>
毕竟使用这台笔记本，会因为网卡是螃蟹最次的那种网卡，而导致网速慢(而且是非常慢！最高速度只有20Mbps！)安装不上一些包
</p>

<p>
从而导致一路上都要手动签名 <code>*( ￣皿￣)/#</code> 甚至即使安装好后，平常滚动时都时不时来一下下载速度过于缓慢的断流问题，简直气死个人
</p>

<p>
你能想象到，有什么会因为网卡过于垃圾，导致有些包装不上，导致了很莫名其妙的错误吗？（别人都没有我这么倒霉过！）
</p>

<p>
再加上，我实在是受不了那破烂笔记本的硬件了，我回顾了一下
</p>

<p>
我居然使用了一台8G(板载4G+插拔4G)内存、45%ntsc屏幕色域、键盘的capslock、tab、escape、f2全部失灵
</p>

<p>
电池寿命只有38%且容量只有2340mA的笔记本，长达一年的Emacs使用时间吗？
</p>

<p>
我甚至因为tab键坏了，至今都还保持着在bash里面 C-i 来补全的行为
</p>

<p>
我甚至因为那两个usb 2.0接口经常松动，导致我如果要插u盘进去都是要看运气的，甚至今天2025年5月2日才发现，原来过去我保存到u盘里的文件
</p>

<p>
从2024年10月5日之后，就全部都是压缩失效的了。也就是说&#x2026;..我2024年10月5日在linux上的数据，统统都看不了了&#x2026;&#x2026;.
</p>

<p>
我甚至还因为f2键坏了，导致我bios/uefi firmware都甚至按不进去（您觉得因为键盘坏了主板设置都BYD进不去的笔记本能有多逆天？）
</p>

<p>
我想，应该没有人比我使用的个人设备(单片机另说哈!)还要差的了！我超，想想当时还是被电脑城奸商6199元买来的。
</p>

<p>
当时我想着，虽然这台笔记本硬件各方面过于垃圾，但它的剪刀脚键盘手感很好，于是就继续忍着使用了。
</p>

<p>
但我现在有Microsoft Designer Compact Keyboard，甚至还有两把，要比这破烂笔记本更爽，做工更好，价格还便宜软软代购只要159元
</p>

<p>
那破烂笔记本赶紧扔了得了，我甚至断言一下，正是这台破烂笔记本，让我个人浪费了很多时间在无意义的事情上  
</p></li>

<li><p>
为了Emacs而使用Linux
</p>

<p>
对于我个人来说，我对Linux的态度，仅仅只是Emacs启动器。
</p>

<p>
但Linux发行版也是有好坏之分的哈，好的Linux安装软件特别方便，而且资料也是公开的，甚至不会的话还可以找热心群友帮忙
</p>

<p>
坏的Linux的话就会讨论很多非Linux的话题，然后资料也是不公开的或者说不允许外人编辑这样，同时安装软件包的包名让人非常难以理解等等
</p></li>

<li><p>
WSL-archlinux有arch官方支持，更有保障了
</p>

<p>
结合WSL2只是 “虚拟机” 的优势，我再也不用担心单显卡drm下带来的各种奇怪小问题了，涉及到非QT的图形界面应用时。
</p></li>

<li><p>
打游戏同时心累了
</p>

<p>
再加上我实在不想，每几天打开那台屏幕垃圾得很的笔记本，原因只是我不想看到这垃圾笔记本，然后每隔几天就要pacman -Syu一下
</p>

<p>
我实在是不想滚了，我本来想找到一个不可变的arch的或类似的，但除了manjaro那个即将释出的，就实在找不到了。
</p>

<p>
我也想过，要不要上可以一劳永逸的声明式系统nixos或guix
</p>

<p>
可是nixos的nix强是强但不够爽，没有guix os的scm那样从头爽到尾的感觉。
</p>

<p>
可是guix的sju的镜像，很抽象很抽象，以至于在我自己的网络环境下面，是不！可！能！成功安装上的。（尝试过很多遍了）
</p>

<p>
最后，我就是想找一个all in one的
</p>

<p>
即既可以打游戏比如星露谷欧卡赛车游戏等等，又可以时不时看一下我个人的【打开linux就仅仅是为了emacs】的个人要求
</p>

<p>
所以，最后因为就是要打游戏（同时我也只剩下台式机这个机器了），所以那么必须要 Windows 了。所以才出来个这么猎奇的想法 <code>^_^</code>
</p></li>
</ul>
</blockquote>
</div>
</div>
<div id="outline-container-org7a2cb24" class="outline-3">
<h3 id="org7a2cb24"><span class="section-number-3">1.3.</span> 方案</h3>
<div class="outline-text-3" id="text-1-3">
<blockquote>
<p>
我超，我可以说这是我研究过最通透的几个方案了。我得一一说明一下，Windows是有它自己的潜力在的。
</p>

<p>
通过下面的描述，甚至可以打破您对Windows印象差的刻板印象
</p>
</blockquote>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">序号</th>
<th scope="col" class="org-left">方案</th>
<th scope="col" class="org-left">适用系统</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-left"><b>WSLg(强烈推荐)</b></td>
<td class="org-left">Win11(只适用于Win11！因为WSLg是Win11独占)</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left"><b>MSYS2</b></td>
<td class="org-left">Win10(Win10用户的选择), Win11(Win11有更接近Linux原生的WSL+WSLg)</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left"><b>WSL + X Server</b></td>
<td class="org-left">Win10(Win10用户的选择), Win11(Win11有更接近Linux原生的WSL+WSLg)</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left"><a href="https://ftp.gnu.org/gnu/emacs/windows/">GNU FTP main server</a></td>
<td class="org-left">（BYD什么时候出的Emacs 30.1在Windows上？我记得我的印象只有Emacs 28.1，所以嫌麻烦的话这也是一个很不错的选择）</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-left"><b>原生Linux环境或虚拟机</b></td>
<td class="org-left">你喜欢就好</td>
</tr>
</tbody>
</table>
</div>
<div id="outline-container-orgad47014" class="outline-4">
<h4 id="orgad47014"><span class="section-number-4">1.3.1.</span> 方案1 - WSLg(Win11用户的选择，强烈推荐！！)</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
要做比较多的前提知识的准备，但是如果您是Emacs老登的话，那相信这些对您来说不过就是小儿科哈！ <code>&lt;(￣︶￣)↗[GO!]</code>
</p>

<p>
啊，您是好奇为什么是 <b>强烈推荐</b> 吗？
</p>

<p>
因为这个原因
</p>
<div class="org-src-container">
<pre class="src src-nil">checking for libgccjit.h... yes
checking for mps.h... yes  
</pre>
</div>

<p>
<b>这就是答案</b>
</p>

<p>
我选择安装的linux发行版，是 <code>Windows Subsystem for Linux - archlinux 2.4.13</code>
</p>

<p>
内核版本是 <code>Linux 5.15.167.4-microsoft-standard-WSL2</code> 
</p>

<p>
其实也就是 <code>wsl -l -o</code> 下的 archlinux
</p>
</div>
<ol class="org-ol">
<li><a id="orgb661e02"></a>wsl安装archlinux<br />
<div class="outline-text-5" id="text-1-3-1-1">
<div class="org-src-container">
<pre class="src src-sh"># powershell管理员身份打开，输入完 "wsl" 加上 "--install"，然后重启
wsl --install

# 然后重启就安装上了wsl本体，然后是安装对应的发行版
# 重启之后，会自动默认安装ubuntu，这里手快一点点取消快点，同时开始菜单卸载就是了
# 查看可用的发行版
wsl -o -l  # 即 wsl --online --list

# 安装wsl-archlinux发行版，很快就安装好了
# 但注意，此wsl-archlinux非彼archlinux
# 在archlinux社区中求助需要特别注明自己的系统为: wsl的archlinux，而非原生的archlinux
wsl --install -d archlinux

# 安装好之后，在 "wsl settings" 里面，需要将网络通信从NAT改成Mirrored，这样才能使用本地代理
# 不然就会用默认配置，去连接geo与rack镜像，很卡的，非常卡！因为没有配置上本地代理
# 甚至这个提示在windows10下都没有的，所以才说WSL2的方法几乎只适用于windows11 []~(￣▽￣)~*

# 顺便一说，在wsl上安装卸载linux，那是真的轻松愉快 []~(￣▽￣)~*
wsl --unregister linux发行版在wsl -l -o中的键名
</pre>
</div>
</div>
</li>
<li><a id="org31f3c10"></a>wsl配置archlinux<br />
<div class="outline-text-5" id="text-1-3-1-2">
<div class="org-src-container">
<pre class="src src-sh"># 设置本地语言
# #en_US.UTF-8 UTF-8   改成   en_US.UTF-8 UTF-8
# #zh_CN.UTF-8 UTF-8   改成   zh_CN.UTF-8 UTF-8
# #zh_TW.UTF-8 UTF-8   改成   zh_TW.UTF-8 UTF-8
# #zh_HK.UTF-8 UTF-8   改成   zh_HK.UTF-8 UTF-8
vim /etc/locale.gen

# 生成语言项
locale-gen

# 设置系统环境语言
# 添加 LANG=zh_CN.UTF-8（因为已经装好了，已经不在tty下了，所以直接设置中文汉语）
vim /etc/locale.conf

# 安装中文字体，来让应用可以支持显示中文
pacman -S wqy-microhei wqy-microhei-lite wqy-bitmapfont wqy-zenhei ttf-arphic-ukai ttf-arphic-uming adobe-source-han-sans-cn-fonts noto-fonts-cjk

# 安装emoji表情，就比如fcitx按;然后出现的那些emoji表情那样
# 原生archlinux是已经装fcitx时已经装好的了，WSL没有装，所以要手动安装
pacman -S noto-fonts-emoji








# 再者，一些Windows应用，比如软软输入法，在通过WSLg显示在Windows界面的GUI版Linux应用，是不能运行的。但TUI版Linux应用就可以
# 说人话，就是终端应用可以用Windows软软输入法，GUI应用不可以用Windows软软输入法。
# 所以如果想在GUI版的Emacs上，能打出中文，同时还可以自由选择输入方案比如双拼五笔声形码这些，就需要下面的安装来安装 emacs-rime 了。下面的链接就是，但fcitx5这里只需要安装 pacman -S fcitx5 fcitx5-rime 就足够了
# https://colfwe.github.io/docs/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1%E5%AE%89%E8%A3%85%E7%8B%97%E5%93%A5%E7%9A%84emacs-rime%E8%BE%93%E5%85%A5%E6%B3%95%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95.html
# 注意fcitx5这里只安装 pacman -S fcitx5 fcitx5-rime  
</pre>
</div>
</div>
</li>
<li><a id="org180657a"></a>wsl编译emacs-feature-igc<br />
<div class="outline-text-5" id="text-1-3-1-3">
<p>
在编译之前，需要安装一些依赖，依赖管理让wsl-archlinux来操作就行，这里属于是“命中关键词”来安装。
</p>
<div class="org-src-container">
<pre class="src src-sh">pacman -S giflib libxpm gtk2 gtk3 libgccjit autoconf make texinfo gnutls pkg-config imagemagick libpng libjpeg texlive mpv

# 给编译tdlib用的，编译tdlib后再通过telega.el，实现 “telega for EmacsOS”
# 这里先说一下，在WSL-archlinux下要玩 “telega for EmacsOS” 的话
# 因为是WSL环境，所以这里在代理环境上有一个大坑，绝对会掉下去的那种
# 在下面可选项这里，就可以看到了
pacman -S gperf cmake

# 给--with-rsvg等的各种显示更具体的图片，的编译选项提供的，一般来说WSL-archlinux已经安装好了
sudo pacman -S libpng libjpeg-turbo libtiff giflib librsvg

# 【可选项】如果要树坐者的话  
sudo pacman -S tree-sitter

# 【可选项】给deadgrep.el使用的抓文本后端
pacman -S ripgrep

# 【可选项】如果在linux原生环境下，有spectacle截图工具可用的话，可以通过xclip来完成org-download操作
pacman -S xclip
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">序号</th>
<th scope="col" class="org-left">包依赖</th>
<th scope="col" class="org-left">为了Emacs而使用Linux</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-left">giflib</td>
<td class="org-left">在Emacs处理gif的库</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">libxpm</td>
<td class="org-left">在X11下操作位图的库</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">gtk2</td>
<td class="org-left">一会开编译命令 &#x2013;with-x-toolkit=gtk3 用的</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-left">gtk3</td>
<td class="org-left">一会开编译命令 &#x2013;with-x-toolkit=gtk3 用的</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left">libgccjit</td>
<td class="org-left">开 native-comp 用的，而且是非常重要</td>
</tr>

<tr>
<td class="org-right">6</td>
<td class="org-left">autoconf</td>
<td class="org-left">能够运行emacs源码包的 ./autogen.sh 用的</td>
</tr>

<tr>
<td class="org-right">7</td>
<td class="org-left">make</td>
<td class="org-left">构建工具</td>
</tr>

<tr>
<td class="org-right">8</td>
<td class="org-left">texinfo</td>
<td class="org-left">在make构建过程时解析文本用的</td>
</tr>

<tr>
<td class="org-right">9</td>
<td class="org-left">gnutls</td>
<td class="org-left">一个tls的gnu工具包，必须要安装，不然不能安全下载从elpa源获取的包</td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-left">pkg-config</td>
<td class="org-left">gnutls的依赖，装上pkg-config才能让编译emacs时检测到有gnutls，参考 <a href="https://www.reddit.com/r/emacs/comments/mqlhcu/building_emacs_on_windows_gnutls_is_not_detected/?rdt=39055%EF%BC%89">红迪</a></td>
</tr>

<tr>
<td class="org-right">11</td>
<td class="org-left">imagemagick</td>
<td class="org-left">在Emacs下处理一些图像用的</td>
</tr>

<tr>
<td class="org-right">12</td>
<td class="org-left">libpng</td>
<td class="org-left">在Emacs下处理一些png图像用的</td>
</tr>

<tr>
<td class="org-right">13</td>
<td class="org-left">libjpeg</td>
<td class="org-left">在Emacs下处理一些jpeg图像用的</td>
</tr>

<tr>
<td class="org-right">14</td>
<td class="org-left">texlive</td>
<td class="org-left">可选项: 如果要写auctex写LaTeX的话</td>
</tr>

<tr>
<td class="org-right">15</td>
<td class="org-left">mpv</td>
<td class="org-left">可选项: 如果要用emms听音乐的话</td>
</tr>

<tr>
<td class="org-right">16</td>
<td class="org-left">gperf</td>
<td class="org-left">可选项: 如果要用telega-server(tdlib)的话</td>
</tr>

<tr>
<td class="org-right">17</td>
<td class="org-left">cmake</td>
<td class="org-left">可选项: 如果要用telega-server(tdlib)的话</td>
</tr>
</tbody>
</table>

<p>
然后就是下载 libmps 的库文件，libmps库文件规格大概是这样的
</p>

<div class="org-src-container">
<pre class="src src-nil">libmps大致信息

.a 静态文件部分
   🔧 libmps.a
   🔧 libmps-debug.a
.h 头文件部分
   🔧 mpsacl.h
   🔧 mpsavm.h
   🔧 mpscamc.h
   🔧 mpscams.h
   🔧 mpscawl.h
   🔧 mpsclo.h
   🔧 mpscmfs.h
   🔧 mpscmv2.h
   🔧 mpscmvff.h
   🔧 mpscmvt.h
   🔧 mpscsnc.h
   🔧 mps.h
   🔧 mpsio.h
   🔧 mpslib.h
   🔧 mpstd.h
   🔧 mpswin.h
</pre>
</div>

<p>
<a href="https://github.com/colfwe/dotfiles/tree/main/libmps">我的仓库 </a>或 <a href="https://github.com/Ravenbrook/mps">作者仓库</a> 里也都有 (20230711, v1.118.0, Release)
</p>

<p>
安装方法就是直接暴力复制到 <code>/usr/bin/ 与 /usr/include/</code> 上就行了
</p>

<p>
然后是 emacs-mirror 的 emacs-feature-igc 分支
</p>

<p>
仓库地址: <a href="https://github.com/emacs-mirror/emacs/tree/feature/igc">emacs-feature-igc</a>
</p>

<p>
推荐提交点: <code>6654ac61342a0a2ffef50435d026cae09314ad5c</code>
</p>

<p>
因为运行无论在archlinux原生还是WSL-archlinux环境下，运行都十分稳定
</p>

<p>
反正在 [我个人的配置上] 在 [非配置情况] 下，一次也没有崩溃过
</p>

<p>
然后就是编译命令，先 <code>chmod +x ./autogen.sh</code> 再运行 <code>./autogen.sh</code> 就得到了 <code>./configure</code>
</p>

<p>
然后要设置几个构建脚本为可执行，反正这在msys2上是要这么操作的，这里也设置为可执行就是了
</p>

<p>
<i>而且我也亲身实验了，即使不在msys2环境上，而是在WSL2环境上，依然也是要进行加权chmod的</i> <code>(～￣▽￣)～</code>
</p>

<div class="org-src-container">
<pre class="src src-sh">chmod +x ./build-aux/move-if-change
chmod +x ./admin/charsets/mapconv
chmod +x ./build-aux/update-subdirs
chmod +x ./build-aux/make-info-dir
</pre>
</div>

<p>
然后我的编译选项，是这样的
</p>

<div class="org-src-container">
<pre class="src src-nil">CFLAGS="-fmax-errors=1000" ./configure \
    --sysconfdir=/etc \                   # 配置文件默认安装到 /etc
    --prefix=/usr \                       # 安装根路径为 /usr（不是 /usr/local）
    --libexecdir=/usr/lib \               # 内部 helper 程序装到 /usr/lib
    --localstatedir=/var \                # 本地变量文件路径（如缓存）设为 /var
    --disable-build-details \             # 不写入构建时间/主机信息，提高构建可重现性
    --with-harfbuzz \                     # 启用 HarfBuzz，提升字体渲染质量（支持 ligatures）
    --with-libsystemd \                   # 启用对 systemd 的支持
    --with-modules \                      # 启用 Emacs 动态模块支持（支持外部模块）
    --with-x-toolkit=gtk3 \               # 使用 GTK3 图形界面（X11）
    --with-mps=yes \                      # 启用 memory pool system（Emacs GC 的替代实现）
    --with-gnutls=ifavailable \           # 启用 GnuTLS 网络安全库（SSL/TLS），如果有的话（在从elpa获取包安装及更新需要用到）
    --with-rsvg \                         # 开启 rsvg（SVG 支持）
    --with-imagemagick \                  # 开启 ImageMagick 支持
    --with-tree-sitter=ifavailable \      # 使用 tree-sitter（语法高亮引擎）如果可用
    'CFLAGS=-march=x86-64 -mtune=generic -O2 -pipe -fno-plt -fexceptions -Wp,-D_FORTIFY_SOURCE=3 -Wformat -Werror=format-security -fstack-clash-protection -fcf-protection -fno-omit-frame-pointer -mno-omit-leaf-frame-pointer -g -ffile-prefix-map=/build/emacs/src=/usr/src/debug/emacs -flto=auto' \
    'LDFLAGS=-Wl,-O1 -Wl,--sort-common -Wl,--as-needed -Wl,-z,relro -Wl,-z,now -Wl,-z,pack-relative-relocs -flto=auto'  
</pre>
</div>

<p>
GPT 4o给出的解释是，你这一定是从Arch等的高级构建模板，已经是非常专业级别的构建选项
</p>

<blockquote>
<p>
BYD还真是，我当时是从 <code>GNU Emacs 29.1</code> 开始使用的，大概2024年4月
</p>

<p>
然后我就从 <code>pacman -S emacs</code> 里，直接复制粘贴pacman包的 <code>system-configuration-options</code> 得到的
</p>

<p>
然后就在上面加加减减修改一下这样
</p>
</blockquote>

<p>
并且GPT对编译flag做出了解释
</p>

<pre class="example" id="org8989159">
✅ 高安全性(-D_FORTIFY_SOURCE=3, -Werror=format-security)

✅ 高优化(-O2, LTO, -march, -mtune)

✅ 高可调试性(-g, -fno-omit-frame-pointer)

✅ 支持丰富组件(tree-sitter、GTK3、modules、libsystemd)

===================== 优化、调试、安全相关 =====================
-march=x86-64                    # 架构通用，兼容大多数 CPU
-mtune=generic                   # 为通用 CPU 调整
-O2                              # 优化等级 O2（推荐级别）
-pipe                            # 用管道而不是临时文件提高编译效率
-fno-plt                         # 更快的函数调用方式（避免 PLT）
-fexceptions                     # 支持异常处理（主要用于 C++ 模块）
-Wp,-D_FORTIFY_SOURCE=3          # 编译期安全检查级别 3（更强）
-Wformat -Werror=format-security # 格式化字符串必须安全
-fstack-clash-protection         # 堆栈碰撞保护
-fcf-protection                  # 控制流保护（CET）
-fno-omit-frame-pointer          # 保留帧指针，方便调试
-mno-omit-leaf-frame-pointer     # 同上，兼容 leaf 函数
-g                               # 启用调试信息
-ffile-prefix-map=...            # 消除调试信息中的路径依赖
-flto=auto                       # 启用 LTO（链接时优化）
===================== 链接器相关优化与安全 =====================
-Wl,-O1                          # 链接器优化等级 1
-Wl,--sort-common                # 优化 common symbol 排序
-Wl,--as-needed                  # 只链接必要的库
-Wl,-z,relro                     # 只读重定位段（安全）
-Wl,-z,now                       # 提前绑定（防延迟绑定攻击）
-Wl,-z,pack-relative-relocs      # 优化位置无关代码重定位
-flto=auto                       # 启用 LTO 优化链接
</pre>

<p>
然后 <code>make</code> 编译，然后 <code>make install</code> 安装。然后检测两个地方
</p>

<p>
<b>检查native-comp</b>
</p>
<div class="org-src-container">
<pre class="src src-elisp">;; 如果C-x C-e运行后，Message回显区，显示了 "t"，那就说明开启了native-comp本地编译
(native-comp-available-p)
</pre>
</div>

<p>
<b>检查igc</b>
</p>
<div class="org-src-container">
<pre class="src src-nil"># 打开Emacs，然后 M(alt)-x 执行 igc-stats，按 wasd 的 s
# 如果能看到
IGC_OBJ_BLV                               1382           66336         48            48
IGC_OBJ_BUILTIN_SUBR                         0               0          0             0
IGC_OBJ_BUILTIN_SYMBOL                       0               0          0             0
IGC_OBJ_BUILTIN_THREAD                       0               0          0             0
IGC_OBJ_BYTES                                0               0          0             0
IGC_OBJ_CONS                           2618570        62845680         24            24
# 就说明igc生效了  
</pre>
</div>

<p>
这样就安装好了emacs-feature-igc
</p>
</div>
<ol class="org-ol">
<li><a id="orgd519168"></a>可选项：如果要装上我个人的配置的话<br />
<ol class="org-ol">
<li><a id="org1d7837d"></a>bash方面<br />
<div class="outline-text-7" id="text-1-3-1-3-1-1">
<p>
将来给eat用的
</p>
<div class="org-src-container">
<pre class="src src-sh"># ~/.bashrc
alias l='ls -ail --color'
alias rm='rm -i'

# ~/.bash_profile
source ~/.bashrc
</pre>
</div>
</div>
</li>
<li><a id="orga10d8ca"></a>telega方面<br />
<div class="outline-text-7" id="text-1-3-1-3-1-2">
<p>
<a href="https://zevlg.github.io/telega.el/#building-tdlib">zevlg作者提供了非常直观清晰的编译方法</a>
</p>

<p>
首先编译tdlib(官方的C++库)
</p>

<div class="org-src-container">
<pre class="src src-sh"># 下载
git clone https://github.com/tdlib/td.git

# 配置
cd td
mkdir build
cd build
cmake ../

# 编译
make -j4   # 4是CPU核心数

# 安装
make install  
</pre>
</div>

<p>
然后安装telega.el，并且构建build出telega-server(前端)
</p>

<p>
然后如果默认在WSL下，有可能因为代理的原因，就会出现一个深渊巨坑
</p>

<p>
我能看到的是，telega-server(前端)显示出来的内容
</p>

<pre class="example" id="org40cce64">
首先能看到的状态是Auth WaitPhoneNumber，同时下面fallback到要通过已登录的用户，对应的账号来登录

(可以在 “三条横线 &gt; 头像名称的下方” 看到自己的账号)

然后当输入完账号后，上方的状态会【立即】变成 Connecting.......，

并且永远都是Connecting，永远都是Connecting，永远都是Connecting.................

永远登不进去。
</pre>

<p>
为什么呢？
</p>

<pre class="example" id="org322bfe8">
这是因为 tdlib 是我们自己拉取通过第三方编译出来的

然后 tdlib 是一个单独的进程，它不识别 Emacs 的环境变量，哪怕你用 export all_proxy=...，tdlib 默认还是会忽略

在WSL环境下
</pre>

<p>
那要如何操作呢？那就要设置一段神必elisp代码，设置telega.el的 <code>telega-proxies</code> 变量
</p>

<div class="org-src-container">
<pre class="src src-elisp">;; 声明: 我完全不懂这些代理相关的，我只想上去听音乐、看沙雕图、看在花新闻
;; 声明: 我完全不懂这些代理相关的，我只想上去听音乐、看沙雕图、看在花新闻
;; 声明: 我完全不懂这些代理相关的，我只想上去听音乐、看沙雕图、看在花新闻

  ;; 作者zevlg提供的
  (setq telega-proxies
        (list
         `(:server "127.0.0.1"
           :port 4781   ; 端口是你自己的代理，的后台服务，的端口号。一般来说好的代理软件都会提示服务端口信息。这里是socks服务的端口
           :enable t
           :type (:@type "proxyTypeSocks5"
                         :username ""
                         :password ""))))
</pre>
</div>
</div>
</li>
<li><a id="orgac2ba72"></a>仪表盘信息相关<br />
<div class="outline-text-7" id="text-1-3-1-3-1-3">
<p>
天气信息(天气信息来源于wttr.in，不要滥用curl，因为天气API总结起来后，还是挺贵的)
</p>
<div class="org-src-container">
<pre class="src src-nil"># 随便弄一个sh脚本(保存完下面的文字后，chmod +x 这个脚本.sh)
# curl wttr.in/当前所居住的城市名称 &gt; /root/.emacs.d/archive/weather
#
# 比如如果在广州(Guangzhou)的话，那就是
#
# curl wttr.in/Guangzhou &gt; /root/.emacs.d/archive/weather  
</pre>
</div>
</div>
</li>
<li><a id="org8152b8b"></a>图标字体<br />
<div class="outline-text-7" id="text-1-3-1-3-1-4">
<p>
(2) 打字体补丁
</p>

<p>
首先下载字体 <a href="https://github.com/kitevnn/dotfiles-archlinux/tree/main/res/font">Sauce Code Pro Semibold Nerd Font Complete Mono</a>
</p>

<p>
然后安装fontforge打补丁程序
</p>

<div class="org-src-container">
<pre class="src src-sh"># fontforge打补丁程序
pacman -S fontforge
</pre>
</div>

<p>
再下载 <a href="https://github.com/ryanoasis/nerd-fonts?tab=readme-ov-file#font-patcher">nf作者提供的font-patcher字体脚本文件</a>
</p>

<p>
然后打补丁
</p>
<div class="org-src-container">
<pre class="src src-sh">fontforge --script ./font-patcher --complete 'Sauce Code Pro Semibold Nerd Font Complete Mono.ttf'
</pre>
</div>

<p>
然后安装字体
</p>
<div class="org-src-container">
<pre class="src src-sh">mkdir -p ~/.local/share/fonts/
mv SauceCodeProNerdFontCompleteMonoNerdFont-SemiBold.ttf ~/.local/share/fonts/
sudo fc-cache -f
</pre>
</div>
</div>
</li>
<li><a id="orge97d139"></a>创建必要的目录及文件<br />
<div class="outline-text-7" id="text-1-3-1-3-1-5">
<div class="org-src-container">
<pre class="src src-sh">cd ~
mkdir -p 桌面
mkdir -p 音乐
cd ./桌面
mkdir -p emacs-org                
mkdir -p emacs-working-denote     
mkdir -p emacs-working-directory
cd emacs-org                
touch 2025.org
</pre>
</div>








<p>
这是方案1 - WSLg
</p>
</div>
</li>
</ol>
</li>
</ol>
</li>
</ol>
</div>
<div id="outline-container-org1410ea8" class="outline-4">
<h4 id="org1410ea8"><span class="section-number-4">1.3.2.</span> 方案2 - MSYS2(Win10用户的选择)</h4>
<div class="outline-text-4" id="text-1-3-2">
<p>
这里下载 <a href="https://www.msys2.org/">msys2.org</a> 软软的msys2，然后相比与WSL来说 <b>MSYS2更多偏向 Windows完全操纵Linux</b> 然而 <b>WSL更多偏向Linux操纵Windows</b>
</p>

<p>
所以对于Windows的Win10用户，在使用emacs-feature-igc上，还是推荐升级Win11来使用 <code>&lt;(￣︶￣)&gt;</code>
</p>

<p>
然后下载 MSYS2 <b>他自己维护的包名</b> 因为这个环境是 MSYS2，所以一些资料是很不好找的！反正就是没有Linux(这里特指archlinux)那样好找就是了 <code>[]~(￣▽￣)~*</code>
</p>

<div class="org-src-container">
<pre class="src src-sh"># MSYS2也是用的pacman包管理器噢，用法全部一样的(～￣▽￣)～
pacman -S mingw-w64-ucrt-x86_64-gcc
</pre>
</div>

<p>
然后如果要编译出Emacs31的话，必须！必须！要使用 /ucrt64 (universe C runtime) 运行环境，而非 /usr 环境，所以如果说这里出现了什么差错的话，资料是很难找的。况且这还是 MSYS2 的 Windows abi。
</p>

<p>
然后我自己也尝试过msys2在win10上的方法，用 <code>ucrt64</code> 编译 emacs-master 可以是可以，但！是！他不支持编译 emacs-feature-igc，即使我已经将 libmps 文件都放在了 /ucrt64 或 /usr 下，它都不支持编译出来！
</p>

<p>
它一定会显示 "The libmps library is Missing"，那就没有办法成功编译出 emacs-feature-igc <code>( ´_ゝ` )</code>
</p>

<p>
哦，你说会有什么缺点啊，那就是master的运行速度会慢很多，对于我个人的配置来说，大概慢个两到三倍的这个样子，相比igc的话
</p>

<p>
还有就是msys2它因为是Windows abi，所以很多内容都是msys2项目维护的，比如各种包名就需要看msys2的文档，比如我想找一个让Emacs开启native-comp的包libgccjit，那么在上面的名称我忘记是什么了，反正好像不叫这个名称。就会多很多负担吧，不好找资料这样。
</p>

<p>
所以对于Windows的Win10用户，在使用emacs-feature-igc上，还是推荐升级Win11来使用 <code>&lt;(￣︶￣)&gt;</code> (毕竟如果WSLg出现了什么问题，还可以甩锅不是嘛 <code>o(≧▽≦)o</code> )
</p>
</div>
</div>
<div id="outline-container-orge7d77f6" class="outline-4">
<h4 id="orge7d77f6"><span class="section-number-4">1.3.3.</span> 方案2 - WSL + X Server(Win10用户的选择)</h4>
<div class="outline-text-4" id="text-1-3-3">
<p>
Win10用户也可以尝试，但不太推荐，这个属于能跑就行的水平，一些性能不够WSLg那样直接，不过更重点的地方，在于如果X Server第三方应用出现了点什么bug，就不太好甩锅。
</p>

<p>
所以对于Win10用户来说，要使用emacs-feature-igc，最好的方法是升级Win11，其次才是MSYS2 (<b>声明: 仅在要使用Emacs的需求上是这样，其他方面我不知道我不懂</b>)
</p>
</div>
</div>
<div id="outline-container-orgab9acd9" class="outline-4">
<h4 id="orgab9acd9"><span class="section-number-4">1.3.4.</span> 方案3 - GNU FTP main Server</h4>
<div class="outline-text-4" id="text-1-3-4">
<p>
可以到 <a href="https://ftp.gnu.org/gnu/emacs/windows/">https://ftp.gnu.org/gnu/emacs/windows/</a> 这里下载已经支持 native-comp 的 Emacs 30.1 Windows版（请支持 GNU/FSF 喵）
</p>

<p>
我的记忆是，当时Windows的Emacs是不维护的了，然后最新版本停在 Emacs 28.1，这就使得很多地方都很难操作。
</p>

<p>
在 Emacs 28.1 上，比如 package.el、dirvish.el 等，都是不支持的。前者还好，可以用 require + 手动下载代替，后者是真的略微难顶
</p>

<p>
因为 dirvish 在 dired-mode 下的文件树侧边栏操作很重要，没有这个对于我自己来说，我都不知道该如何高效处理文件了
</p>

<p>
还有就是，Windows版的原生Emacs 28.1，它是因为没有 libgccjit 所以导致默认不支持 native-comp 的
</p>

<p>
于是就会在各种使用过程中，看到因为缺少了 libgccjit 的 native-comp，导致各种奇奇怪怪的错误出现。
</p>

<p>
现在Windows版的Emacs升级到了 30.1，那看来应该挺不错的，嫌麻烦的话，其实这也是一个很不错的选择。
</p>
</div>
</div>
</div>
<div id="outline-container-org8dd1efc" class="outline-3">
<h3 id="org8dd1efc"><span class="section-number-3">1.4.</span> 转发fc教授的一句话</h3>
<div class="outline-text-3" id="text-1-4">
<pre class="example" id="orgb9e16dd">
回到wsl，我觉得有两种可能:
  
1. 微软内部员工也厌倦了 Windows 作为开发平台不好用的事实，同时微软的合作伙伴们也希望微软平台能有兼容 Linux 用户空间程序的方案。来自 macos 抢占开发者平台市场估有率的压力也很大，以及 Windows Mobile 计划失败之后对 wsa 的需求，所以微软需要 wsl。

2. 微软一贯的 *Embrace, extend, and extinguish* 要毁灭一个东西第一步是兼容它，抢了一部分占有率之后引入微软特有的不兼容，然后抢过来。到底是 1 还是 2，或者是两者同时，我看不清。目前微软的 2 的 extent 还仅限于 wslg 那个图形驱动栈方面的动作，值得警惕但是还没到不兼容的地步。
</pre>
</div>
</div>
<div id="outline-container-org964dcd9" class="outline-3">
<h3 id="org964dcd9"><span class="section-number-3">1.5.</span> 个人暴论时刻</h3>
<div class="outline-text-3" id="text-1-5">
</div>
<div id="outline-container-orgea05179" class="outline-4">
<h4 id="orgea05179"><span class="section-number-4">1.5.1.</span> 【个人暴论】WSL+WSLg只适合GUI应用，不太适合CLI应用</h4>
<div class="outline-text-4" id="text-1-5-1">
<p>
因为在我个人的操作过程中，我在一个 git 仓库下，执行 <code>git log</code> 会出现这样的 <b>错误提示</b>
</p>

<pre class="example" id="org9c51135">
error: cannot run less: No such file or directory
fatal: unable to execute pager 'less'
</pre>

<p>
然而，如果我使用 magit 的话，一切正常，而且正常无比。速度响应之快完全就像在 Linux 环境下运行一样，完全就不是在 Windows 下运行的
</p>

<p>
同时在我个人的操作过程中，船新打开的 wsl (就是比如在 cmd 或 powershell 执行 wsl 得到的 wsl-archlinux 环境)
</p>

<p>
它默认情况下，是不会自动加载 <code>~/.bashrc</code> 的，所以我的一些 alias 就没办法自动加载，必须手动一下 <code>source ~/.bashrc</code> 才能加载
</p>

<p>
然而，如果我使用 emacs 上的 eat，那么就会是 <b>【自动加载 ~/.bashrc】</b> 的，不知道是什么原因，总之很好用就是了。
</p>

<pre class="example" id="org2fcdcc4">
暴论：怀疑软软内部也有用Emacs的自己人，不然不可能怎么就在【默认情况的WSL】下只有magit能用，然而git不能用的 ∑(￣口￣||  要么就只有是magit提前预料到开发好了 (～￣▽￣)～
</pre>
</div>
</div>
<div id="outline-container-org221e96e" class="outline-4">
<h4 id="org221e96e"><span class="section-number-4">1.5.2.</span> 【个人暴论】你说我什么时候会回到linux啊？</h4>
<div class="outline-text-4" id="text-1-5-2">
<p>
可能等我什么时候有钱买台高配笔记本，且不心疼钱财的时候，那个时候可能会回归，不过现在来看，那恐怕是一段很漫长的时间了，因为现在这个更好用，玩玩Emacs的同时还能打游戏 <code>&lt;(￣︶￣)&gt;</code>
</p>
</div>
</div>
</div>
<div id="outline-container-orgb925461" class="outline-3">
<h3 id="orgb925461"><span class="section-number-3">1.6.</span> 一些问题</h3>
<div class="outline-text-3" id="text-1-6">
</div>
<div id="outline-container-org7bf9872" class="outline-4">
<h4 id="org7bf9872"><span class="section-number-4">1.6.1.</span> 【闲谈】emacs-rime 的 posframe 会很卡很卡</h4>
<div class="outline-text-4" id="text-1-6-1">
<p>
在 WSL 上使用 emacs-rime 的 posframe 跟随光标，会非常非常卡
</p>

<p>
卡顿的程度，就约等于是用我那破烂笔记本写大概 6000 行 org inline LaTeX 带中文字符且是超长公式的那种程度，大致是那个卡顿程度，很难受
</p>

<p>
这么说的话，看来 WSLg 下的 emacs-rime 的候选区放在 <b>回显区Message</b> 看来是非常有道理的 <code>(～￣▽￣)～</code>
</p>

<p>
候选区放在回显区，唯一的缺点，应该就是不好选词，因为眼睛要一边看上屏的首选文字，一边看双拼里面可能会重码的词。可能会比较累
</p>

<p>
但双拼可以通过打词组来规避这一问题，如果非要彻底解决的话，就上手重码率低的五笔吧
</p>

<p>
不过五笔对于我个人的不好之处，是在于 【学习成本是真的高，更适合看打不适合想打，更适合打单字】
</p>

<p>
对于我个人来说，学习五笔的最大问题，可能还是在打非古文文章时，打字速度可能还不如双拼的 \( \frac{1}{4} \) 倍的速度
</p>

<p>
毕竟自己练习了那么久，却只有几乎不到50 cpm的输入，是很难受的。所以我放弃了五笔，还是双拼最好 <code>╰(*°▽°*)╯</code>
</p>
</div>
</div>
<div id="outline-container-orgefff1b2" class="outline-4">
<h4 id="orgefff1b2"><span class="section-number-4">1.6.2.</span> 【闲谈】WSL环境问题: 我当时还需要这样做的，现在不需要了</h4>
<div class="outline-text-4" id="text-1-6-2">
<p>
我不知道原因是啥
</p>

<p>
但我个人猜测(暴论)
</p>

<p>
可能是WSL到archlinux的一些桌面服务器没fallback上导致的
</p>

<p>
<b>也就是说，如果要通过WSLg直接启动Emacs的话，直接下面这样来打开</b>
</p>

<div class="org-src-container">
<pre class="src src-sh">&gt; emacs  
</pre>
</div>

<p>
<b>就可以了。也就是说，下面的都不用看了。</b>
</p>

<div class="org-src-container">
<pre class="src src-sh"># 使用WSLg，从而使得让Linux的GUI应用，可以rdp到Windows界面上
# 他WSLg说的默认支持，是因为他是默认支持在ubuntu上，你看他WSLg的宣传界面都是ubuntu的皇冠界面，可我这是archlinux啊，所以就需要一些设置
# 我也是询问AI后，几乎绝望之后才知道的
# 总结起来的意思是，让Weston(一个Wayland窗口管理器)跑在X11上，或让Wayland协议跑XWayland应用

# 安装
pacman -S xdg-desktop-portal-wlr pipewire wireplumber weston dbus
# 运行，目的其实是Wayland协议跑XWayland应用。
weston --backend=headless-backend.so &amp;
# 然后运行这一次就可以了



# 奇怪了，我明明昨天必须要这么输入才可以进行下去的
# 今天输入了后就说 could not load dnd-move/dnd-copy 什么的，然后不用管这个直接运行WSLg就可以了





# 方法来自于 https://www.cnblogs.com/ThousandPine/p/18616359
# 还有一点的就是，好像是要创建 socket 双向长久连接
# 手动创建链接，WSL 每次重启都要重新输入
# 稍后会介绍自动创建链接的方法
sudo rm -r /tmp/.X11-unix                   # 删除未链接的文件
ln -s /mnt/wslg/.X11-unix /tmp/.X11-unix    # 重新创建文件链接
# 然后就会有个名称为 "X0" 的 socket 文件
# 然后每次打开WSL，都创建这个文件
# 在 /etc/tmpfiles.d/wslg.conf 写
#  This file is part of the debianisation of systemd.
#
#  systemd is free software; you can redistribute it and/or modify it
#  under the terms of the GNU General Public License as published by
#  the Free Software Foundation; either version 2 of the License, or
#  (at your option) any later version.

# See tmpfiles.d(5) for details

# Type Path           Mode UID  GID  Age Argument
L+     /tmp/.X11-unix -    -    -    -   /mnt/wslg/.X11-unix

</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orga90d2c6" class="outline-3">
<h3 id="orga90d2c6"><span class="section-number-3">1.7.</span> 一些感受</h3>
<div class="outline-text-3" id="text-1-7">
</div>
<div id="outline-container-orge0979db" class="outline-4">
<h4 id="orge0979db"><span class="section-number-4">1.7.1.</span> 20250610</h4>
<div class="outline-text-4" id="text-1-7-1">
<p>
BYD配置配到我都麻了，从0608到0610总共3天的时间全在配置上了
</p>

<p>
是这样的，首先我有一个自己缝出来的uptime函数
</p>

<p>
它可以记录每次使用了多长的时间
</p>

<p>
然后通过bash脚本统计并保存在名为uptime的文件上
</p>

<p>
最后再赋值给elisp的一个变量上
</p>

<p>
这个变量可以展示一共显示了多久的Emacs使用时长
</p>

<p>
所以在写这篇文章时，我当前的时长是
</p>
<pre class="example" id="orgfe0e335">
Accompanying With GNU Emacs: 46 hours, 46 minutes, 40 seconds
</pre>

<p>
然后我的uptime文件，全部都是这样的格式
</p>
<pre class="example" id="orgbffe0f4">
Uptime: xxxxxxxxxxxxxxxxxxxxxxxxxxx
Uptime: 4 seconds
Uptime: 1 minute, 39 seconds
Uptime: 7 minutes, 29 seconds
Uptime: xxxxxxxxxxxxxxxxxxxxxxxxxxx
</pre>

<p>
然后我尝试统计，从0608到0610，这3天的时间里，我一共打开关闭了Emacs多少次
</p>

<p>
结果就是嘛
</p>
<pre class="example" id="org172c546">
&gt; cat uptime | wc -l
708
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: kle</p>
<p class="date">Created: 2025-06-11 Wed 01:55</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
